function [E2, E2HT] = E2_M_ANN(Vf, Ef, Em)
% This function compute E2 of a unidirectional composite
%
% The entries are: 
%    - Volumetric fraction of fiber (Vf)
%    - Longitudinal elasticity modulus of the fiber (Ef), in GPa
%    - Elastic modulus of the matrix (Em), in GPa

% The outputs are:
%    - Transverse elasticity modulus of the laminae (E2), in GPa, from Mix-ANN
%    - Transverse elasticity modulus of the laminae (E2HT), in GPa, from HT

% Mix-ANN - Mixed artificial neural network
% HT - Halpin-Tsai model

% For more information see this webpage:
% COLOCAR LINK!

if Ef>90
    warndlg('The value of Ef must be less than 90','Warning!');
end
if Em>5
    warndlg('The value of Em must be less than 5','Warning!');
end
if Vf>0.75
    warndlg('The value of Vf must be less than 0.75','Warning!');
    return;
end

%% Data Normalization
Ef_nor = Ef/90;
Em_nor = Em/5;

%% Halpin-Tsai Value
N = (((Ef./Em)-1)./((Ef./Em)+2));
E2HT = ((1+(2.*N.*Vf))./(1-(N.*Vf))).*Em; % Show Halpin-Tsai E2 value

%% ANN Mixed Weights
W = [-0.480055854590517 0.216883800492648 0.659566386992146 -0.317921266087999;...
-0.0677959463916261 -0.406978808631778 -0.0179935826547288 -1.92804300641249;...
-1.11014825346142 0.00512387371711537 -0.176032292093845 0.851221670097438;...
1.06845200447262 0.265944264547312 -0.288338700117601 -0.760623717876484;...
0.196674908289514 -0.0274353403197186 -0.783276545942312 -1.66779552837883;...
1.86873934317476 0.307962292383792 -0.245696061403524 0.191776373323290;...
0.289197065205643 1.10637656652765 -0.542951284009924 -1.77010954887455;...
0.450772404198524 0.496092578297534 -1.80657359096456 -0.919451055191330;...
1.37584386502348 0.153855926118933 -1.48808044649743 -1.53805105022203;...
1.52620092932333 0.226388697981074 1.24542000995307 -1.44160643307248;...
1.56052347915749 0.707940486232663 -1.15928599259301 0.0466290035700380;...
0.405048624579758 0.186633223962735 -0.850807683826777 -0.886015509544089;...
1.25046451216865 0.124853568648015 -0.353813762857501 -0.275857275235253;...
0.120508426121450 0.199297476057518 -0.164420799842865 -0.0486555736091737;...
-1.91004317070586 -1.25468759822594 0.197996219067072 -0.443761589105899;...
2.19694438154575 0.788032017457292 -1.75782995818980 -2.36433249195123;...
0.515071157549955 0.185110581947748 -0.420848069022263 -0.969758400476685;...
0.0374571994757854 1.30420782390736 -1.22051563445398 -1.47965817876918;...
1.37475031751696 0.478304210441872 -1.67131497556123 -1.77121864212897;...
0.733445571378603 -1.14831237933401 -1.32884105968183 0.0726024948011645;...
1.30723012520417 -1.62564892754423 -1.58266215823452 1.87109167387844;...
1.16941751524423 -1.49281716360249 0.175803400730191 -0.283542050337400;...
1.66067296861301 -1.53965289007648 -3.04291897761527 1.03493951465086;...
2.00767759803520 1.34326756576094 -1.30959617251205 -0.355705736004137;...
1.00243644580729 0.297952348488785 -2.19210870097495 0.377439675622764;...
0.753501949020906 0.0957172837822156 0.168515545591241 -1.19605901811640;...
0.121688918204888 -1.73017133401030 -0.137298598725223 -1.26494368600397;...
1.15760195457245 1.90036928908164 -1.91653892686913 -0.173744074430405;...
2.15294145263906 0.606304865885289 0.100520581794945 -0.577583109485504;...
-0.521039918891735 0.274274146196086 -0.0242262830210985 -2.10940757176763;...
0.950782491326420 -0.497619061693479 -0.455248607447464 1.12383579820860;...
1.46518116193484 0.685623040282756 0.638692759273448 0.238074011551603;...
1.00974951644571 -1.11589232527060 -0.286054849985631 -0.239907871277544;...
0.563538165791833 -0.587226400574649 -0.176610346878977 -1.79498325098274;...
0.652344434341638 0.759573651614172 0.126556990066676 -0.932280689776439;...
1.50525300367958 -0.958421550335873 -0.471243004897109 -0.908044596204941;...
1.90077804934759 -0.903032013577884 1.04742556196939 -0.480208771344179;...
0.969529309075626 -1.09011613706170 0.620695436633823 -0.928509089509060;...
-0.453002318677673 -1.85037274251073 0.0240445485520455 -1.12170958049345;...
1.51948419482658 -1.78069993353910 0.506989842575022 -1.60109319222551;...
0.159524117956577 0.464955392328659 -0.594684155340383 -1.38871014990813;...
0.0854002600423328 -0.0424804742801493 -0.574628060793070 -1.89070750374957;...
0.0994499474144418 1.04978755475642 -1.48672979880090 -1.29234568193802;...
1.41371468907780 -0.824801832526400 -0.743979109588657 -1.15763402692276;...
2.22939846518089 -0.209158109286902 -0.354566425993423 -0.848871120118033;...
0.539765045522773 -1.72997650583838 -0.103989780683575 -0.277215528527805;...
-0.524875041680681 -1.18980726397693 -1.18804421848309 -0.637946779576165;0.0376025270617707 1.75549814797111 -0.950626894535762 -2.52424036423608];

V = [0.0617791213180658;-1.03455867930868;0.324265514144410;1.17210904799388;-0.281783630420549;-0.733457399531390;...
0.595695789432809;-0.0356898533890150;-0.760080442428299;1.91907977073833;0.155677086994271;0.109759141797724;...
-0.389910232141959;-0.355559496988542;0.253158961033530;-1.33530744073135;0.528561480304385;-0.162055725665183;...
-0.0776746545327701;1.96953343878433;-0.581605176775740;0.191984406892224;0.321948583100557;-0.184901567333083;...
-0.143749384547993;0.253558378733081;0.0902654629958622;0.0870076043515619;0.299326190162135;0.902802212043618;...
0.690147565970402;0.201255657834391;0.0476613970881085;0.561099077612805;0.280562066452758;0.392346548382964;...
1.68408743834162;-0.123761651012489;0.562512706522466;0.113937701961943;0.210249271328330;-0.505639687660090;...
-0.763466864276437;0.00211783153294872;-0.724537384456249;0.325066468787713;0.450748769859178;-0.126798653736488;-0.0994783714709303];

%% Final Calculation
v = W*[-1; Vf; Ef_nor; Em_nor];
y = 1./(1+exp(-v));
E2_nor = V'*[-1;y];
E2 = E2_nor*15+E2HT;

