function [Yt_Mix, Yt_teo] = Yt_M_ANN(Tm, Vf, Eft, Em, Vv)
% This function compute Yt of a unidirectional composite
%
% The entries are: 
%    - Tensile strength of the matrix (Tm), in MPa
%    - Volumetric fraction of fiber (Vf)
%    - Transverse elasticity modulus of the fiber (Eft), in GPa
%    - Elasticity modulus of the matrix (Em), in GPa 
%    - Void volume fraction (Vv)

% The outputs are:  
%    - Transverse tensile strength of the laminae (Yt_Mix), in MPa, from Mix-ANN
%    - Transverse tensile strength of the laminae (Yt_teo), in MPa, from the Equation 2;

% Mix-ANN - Mixed artificial neural network
% Equation 2 - Empirical Equation

% For more information see this webpage:
% https://github.com/giobrol/ANN_functions

TmMax = 150;
EmMax = 5;
YtMax = 150;
EftMax = 100;
VvMax = 0.1;

if Tm>150
    warndlg('The value of Tm must be less than 150 MPa','Warning!');
end
if Vf>1
    warndlg('The value of Vf must be less than 1','Warning!');
end
if Em>5
    warndlg('The value of Em must be less than 5 GPa','Warning!');
end
if Eft>100
    warndlg('The value of Eft must be less than 100 GPa','Warning!');
    return;
end
if Vv>0.1
    warndlg('The value of Vv must be less than 0.1','Warning!');
    return;
end


%%%%% %% Data Normalization
Tm_nor=Tm./TmMax;
Em_nor=Em./EmMax;
Eft_nor=Eft./EftMax;
Vv_nor=Vv./VvMax;


%% Theoric Equation Value
Cv = 1-sqrt((4*Vv)./(pi*(1-Vf)));
Yt_teo = Tm.*Cv.*(1+(Vf-sqrt(Vf)).*(1-Em./Eft));
Yt_teo_nor=Yt_teo./TmMax;

%% ANN Mixed Weights
V_EQ2_3E = [0.707409824835132;-2.47935480926033;-4.73660242049284;-0.0838775085226281;0.243301012260261;0.361190782819729;-7.08677608277018;0.0306527995806673;-0.0230764225522880;0.931596225609730;0.614622077626098;-1.73386741072558;0.492742446534921;0.214753533838286;-2.02245959073600;0.978188690980052;0.660394829541460;-5.79833495412658;2.11580830649039;-0.242487598410043;1.16079516843993;-0.0329386641816811;0.342114293750596;-5.76187418911256;1.78327562891716;0.484131362631083;-0.552346035460868;2.19372917440490;2.00450678285892;-3.91059591437376;-4.08711404369716;1.66142009703367;1.12311903319091;-1.43591737542673;-5.21785264416601;2.76687113925329;-0.646850759729266;-1.84700027449249;-0.462551430318002;2.24357417917420;0.530797693921617;-5.81888389872286;2.82749338127619;0.230910242163894;0.891791767185470;-2.11944714441806;1.05728455960210;-1.25578306026234;0.275741993630582;-0.508002149288108;-0.253496740450902;3.00469607823923;0.120094482049577;0.797830682067135;1.43941309869953;1.23660400944445;-1.19667591089585;-0.0603164940098768;0.0665860287156969;0.219996605130296;0.532620822468499;-2.06797309894087;-0.982544703696567;-5.82266945827496;0.505669145408496;-2.95673462802983;-0.527820655830337;-3.50827073754996;0.455978613549070;-3.11767743071925;-2.13070251395416];
W_EQ2_3E = [4.35704765258845 -0.395472057289979 -28.5535080572874 -0.512528613696375;2.83842994248237 -1.81970570553936 -4.07785101660730 1.44333549999387;1.19129448974218 -0.260269916229120 -2.07272134567666 1.18364886545804;1.60353572555034 0.784714274476056 -1.69815937988365 0.331879872196025;1.15786679124245 0.773680679088978 -2.30563716094674 0.0984280528949327;2.24682048767324 0.442261863536408 -3.50231492357354 -0.953577513822884;1.43096220725640 1.88153266310753 -2.62045372585547 1.25924036585783;0.942586450975063 -0.425674888653383 -2.18276116319465 0.745471046382935;1.49489899148827 -2.72873956625666 -0.340161819875706 -2.32210935852047;1.14697039165032 1.33594065393106 -2.13783415306666 -0.921101672418244;0.956293457999525 -0.876302849746796 -2.14635089242051 -1.80981455013522;4.67452879735487 -8.15485849449375 0.766677923902146 0.549561527971979;0.756751895898256 0.555203876727701 -3.08943232945005 0.994015205548575;1.69433419216706 0.609246421379205 -2.76414245073766 1.19001017685071;1.81488405951277 -0.890630866076051 -0.629043074942665 0.634231147745080;3.19013495566448 11.3192819432012 -0.863881505692015 4.55564552483572;3.04331101146434 0.135808326115205 -6.95092170261775 -0.802154047596218;0.359408261203878 -1.29068757397371 -4.26406379371855 -1.09096057690612;10.2400748727064 0.320400903828710 1.48875258985991 1.58810143596421;0.850966542261447 -2.17633639623573 -0.558356765862697 0.333481564535208;0.893460586430558 0.425979070572300 -2.32725640583686 -1.19403414733889;1.63880582858078 0.500579306616786 -1.40231004858428 -0.652832749976603;2.44614705898778 0.0836322122085713 -2.82580958491171 -0.603143449202383;1.77183763374996 0.323446303179757 -2.78937655898686 -0.627346346064053;3.50978857973318 -4.76371437422448 1.49777204210080 1.81775369404814;2.54294783797706 2.03103824729688 -0.494994446025732 -0.374990820519456;1.35478551497833 -1.15023541543934 -3.42560214441567 1.66870918099503;1.82790893388155 0.880281675682167 -3.18329330994569 -1.62833120425944;1.17633433320637 -0.105890811950511 -10.0638669362952 0.625760066660298;2.93311426999507 -2.76802803273042 -1.68190386834106 -0.419186260947350;0.162594576916278 2.57823118908046 -5.91093235795876 -0.836142797011884;-0.721999980618815 -0.848503365350706 -6.19359916676052 0.113159821358169;1.69035065299574 -0.973237758386949 -2.01471685640401 2.07644159881943;1.23437737931127 0.582281619845921 -5.01645694748285 1.53964904612118;-0.431900177472853 -2.75859779625785 -3.89553413140239 0.526095078200401;2.50627477806339 2.43298263446191 -0.553319408436474 0.0101935762156394;3.25248357983850 0.819694326763666 -15.9849964979375 -0.438520208753971;2.80074609698547 0.131854225081542 -19.1763264343315 0.718670691441731;0.732315887897951 -1.42062993328053 -3.80441458366715 1.27670111016843;1.42532613205132 1.03961878251929 -1.63352609634864 -1.13401361454736;1.61513819446451 0.0318360563541994 -3.51190202676200 -2.20960750552065;3.58731287194822 0.0324078652968043 -3.33475555598712 -0.894479631186484;1.06210056566837 -0.592254076638315 -2.54004970347918 1.67747514995208;1.47941349655120 -0.798381155387106 -0.649276027442999 -1.15324062809378;3.41328676166397 -0.587771501140156 -22.7670180880023 -0.829386717183196;1.30965989612568 -1.30735950249459 -0.590767873383532 -0.238325610018732;3.54770602607972 0.169090823777304 -19.6677710643588 -0.694158396764560;1.14466546362287 -1.63714112029431 -2.61866411781157 -0.0417267686675526;11.1289942402589 -0.644422799704286 -37.7505596967572 -0.641072405235795;2.59434296446862 0.00697613594895269 -1.33028847134367 0.174569518067533;2.31668722234571 3.12448211257456 -9.33452208134688 0.982426124667938;1.28673849012520 1.28642760315567 -2.40450627398818 0.0802936817582479;1.22085527464840 -0.824981848272675 -11.5350107881333 -0.442693487169012;2.87384470751991 -0.0170395725238703 -2.87997072149041 -0.310429277601142;0.627099486580636 -2.89452409714028 -0.545289281180952 0.994658189588187;0.0650972024938581 -0.975537757036952 -2.16447350150404 -2.86906274136447;0.833057986532235 0.245005628454004 -2.40647774692897 0.210043750147683;0.165930578328613 1.55528648024853 -3.71003146066388 -0.322185014780533;0.953773618299967 0.921384285880651 -2.31247948061330 -1.31748223316061;1.43443370346029 -1.46355198233265 -3.46259121012111 -1.41413100201283;3.92494860249486 -0.207008387180983 -14.7660891441337 0.0782320250871476;1.55760036780502 -0.702757584501818 -2.00165736246007 -0.318330088890138;2.29122548337675 1.06326861629132 -3.78593378631672 0.857837304323641;1.33736155647520 0.986153493256105 -1.76524934412486 -0.923707513729090;1.25047918488374 -0.378756128511244 -2.49448270516952 -2.79057043320803;0.946264807771320 0.805566603713050 -2.45613700829237 1.92458973269440;1.66154482954577 -0.429706194070522 -5.73843586190654 -1.31513941946349;1.70577703215967 0.524896792785222 -1.23052684456885 -0.850188164846216;1.00857669956087 0.869142574742238 -4.28170128117724 0.373249680561266;4.70588920882491 1.49885144106983 -10.0623885556319 0.764822380003950];

W=W_EQ2_3E;
V=V_EQ2_3E;

%% Final Calculation
v = W*[-1; Vf; Em_nor./Eft_nor; Vv_nor];
y = 1./(1+exp(-v)); 
z = V'*[-1;y];
Yt_Mix=(Yt_teo_nor./Tm_nor+z).*Tm_nor.*YtMax;
